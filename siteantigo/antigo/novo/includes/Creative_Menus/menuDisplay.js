var XTDCreativeMenusObj;var newSize;function buildMenu(){XTDCreativeMenusObj=new CreativeMenus();newSize=XTDCreativeMenusObj.newSize;if(this['swfobject']!=undefined&&this['swfobject']!=null&&(XTDCreativeMenusObj.a()=="IE8"||XTDCreativeMenusObj.a()=="IE7"||XTDCreativeMenusObj.a()=="IE6")){var ck="XTDCreativeMenusObj.buildMenu()";XTDCreativeMenusObj.c(ck);}else{XTDCreativeMenusObj.buildMenu();}}function CreativeMenus(){this.buildMenu=buildMenu;this.newSize=newSize;this.c=c;this.a=a;function c(ck){var d=window.onload;if(typeof window.onload!='function'){window.onload=function(){eval(ck);}}else{window.onload=function(){if(d){d();}eval(ck);}}}var cl=new Array();cl["H"]="Dropdown_Menu";cl["V"]="Vertical_Menu";cl["T"]="Tabbed_Menu";var f=new Array();var g=new Array();var cm=new Array();var cn=new Array();var co=-1;var cp=a();var l=m();function n(o){}function cq(){for(var q=0;q<f.length;q++){f[q].r.style.width=s(f[q].cr,f[q].u);f[q].r.style.left=v(f[q].cr,f[q].u);if(f[q].u)f[q].cs.style.left=x(q)+"px";if(ct())z(f[q].name);if(A())B(f[q].name,true);}}function C(){for(var q=0;q<f.length;q++){var D=s(f[q].cr,f[q].u);var E=f[q].r.style.height;if(f[q].u)f[q].r.style.width=D;if(ct())z(f[q].name);if(A())B(f[q].name,true);}}window.onresize=cq;window.onscroll=C;var F=true;var u=false;function redim(G){var H=document.getElementById('creative_menu_'+G);var I=H.getAttribute("menu_type");var cs=document.getElementById("menu_holder_"+G);var J=document.getElementById("CMPH_"+G);var K=L(J,"","IMG");H.style.top=M(K)+"px";H.style.left=v(K,g[G].u);H.style.width=(!g[G].u)?g[G].width+"px":(N()+O())+"px";H.style.height=g[G].height+"px";cs.style.position="absolute";cs.align="left";if(g[G].u)cs.style.left=x(g[G].index)+"px";cs.style.width="2000px";if(ct())z(G);}function buildMenu(){var f=document.getElementsByTagName("DIV");for(var q=0;q<f.length;q++){if((f[q].id)&&((f[q].id).indexOf("creative_menu_")!=-1)){P(f[q]);if(F){var Q="redim('"+f[q].id.replace('creative_menu_','')+"')";c(Q);}}}F=false;}function R(name,type,r,cs,cr,u,width,height){var index=f.length;var S=new Object();S.index=index;S.name=name;S.type=type;S.r=r;S.cs=cs;S.cr=cr;S.u=u;S.width=width;S.height=height;f[index]=S;g[name]=S;f[index].T=g[name].T=U(index);f[index].V=g[name].V=W(index);}var X;function P(H){if(H.id=='creative_menu_structure')return;var Y=H.id;var G=Y.slice(14);var I=H.getAttribute("menu_type");var cs=document.getElementById("menu_holder_"+G);var J=document.getElementById("CMPH_"+G);var K=L(J,"","IMG");ck=cs.innerHTML.replace(/<!--\(start.*menu.*data\)/g,'').replace(/\(end.*menu.*data\)-->/g,'');var r=document.createElement('div');r.innerHTML=ck;var Z=L(r,"menu_options","");cs.appendChild(Z);var ba=L(cs,"menu_options");if(!I){I=ba.getAttribute("menu_type");}var width=ba.getAttribute("totalwidth");var height=ba.getAttribute("totalheight");var u=ba.getAttribute("fittopage");var bb=ba.getAttribute("menuzindex");var bc=ba.getAttribute("cutroundcorners");u=(u=="false")?false:true;bc=(bc=="false")?false:true;var bd=document.createElement('div');bd.setAttribute("height",height);bd.setAttribute("width",width);R(G,I,H,cs,K,u,width,height);H.style.zIndex=bb;H.style.position="absolute";H.style.overflow="hidden";H.align="left";H.style.top=M(K)+"px";H.style.left=v(K,u);H.style.width=(!u)?width+"px":(N()+O())+"px";H.style.height=height+"px";cs.style.position="absolute";cs.align="left";if(u)cs.style.left=x(g[G].index)+"px";cs.style.width="2000px";if(ct())z(G);var be=bf();var bg=be+cl[I]+"/creative_dw_menu_"+I.toLowerCase()+".swf";if(A()||ct()){var D=Number(H.style.width.replace('px',''))+Math.abs(Number(cs.style.left.replace('px','')));var E=H.style.height.replace('px','');var bh=new SWFObject(bg,"creative_menu_"+G+"_swf",D,E,"8","#336699");}else{var bh=new SWFObject(bg,"creative_menu_"+G+"_swf","100%","2000","8","#336699");}if(a().indexOf('IE')!=-1){bh.addParam("swLiveConnect","true");}bi(Y,bh,I);bh.addVariable("menu_type",I);bh.addVariable("fittopage",u);bh.addVariable("cutroundcorners",bc);bh.addVariable("lextraspace",g[G].T);bh.addVariable("rextraspace",g[G].V);bh.addVariable('page_id',bj(G));bh.addVariable('page_url',location.href);bh.addVariable('cm_name',G);bh.addVariable('opsys',l);bh.addVariable('browser',cp);bh.addParam("wmode","transparent");bh.addParam("allowScriptAccess","sameDomain");bh.addParam("scale","noscale");bh.write("menu_holder_"+G);}function bf(){var scripts=document.getElementsByTagName("SCRIPT");var bk;for(var bl=0;bl<scripts.length;bl++){if(((scripts[bl].src).indexOf("menuDisplay.js")!=-1)&&(scripts[bl].src)){bk=scripts[bl].getAttribute("src");}}return String(bk).replace('menuDisplay.js','');}function s(cr,u){return(!u)?cr.getAttribute("width")+"px":(N()+O())+"px";}function v(cr,u){return(u)?(0-bm(cr))+"px":bn(cr)+"px";}function x(q){var bo=bp(f[q].cr);return bo-f[q].T;}function U(q){return(f[q].u)?(2000-f[q].width)/2:0;}function W(q){return(f[q].u)?(2000-f[q].width)/2:0;}function bj(G){var bq=location.href;var id="";if(bq.indexOf('?'+G+'_select=')!=-1||bq.indexOf('&'+G+'_select=')!=-1){var q=(bq.indexOf('?'+G+'_select=')==-1)?bq.indexOf('&'+G+'_select='):bq.indexOf('?'+G+'_select=');id=bq.substr(q+G.length+9);if(id.indexOf('&')!=-1)id=id.substr(0,id.indexOf('&'));}return id;}function bi(br,bh){var G=br.slice(14);var cs=document.getElementById("menu_holder_"+G);var bs=document.getElementById(br);var bt=cs.childNodes;var bu=new Array();for(var q=0;q<bt.length;q++){if(bt[q].id=="menu_options"){bv=bt[q];var bw=bt[q].attributes;var u=bw["fitToPage"];for(var bx=0;bx<bw.length;bx++){if((bw[bx].name)&&(bw[bx]["name"]!=undefined)&&(bw[bx].value!=undefined)&&(bw[bx]["name"]!="ID")&&(bw[bx].name!=null)){var by=bw[bx].value;by=by.replace(/#/g,"0x");bh.addVariable(String(bw[bx]["name"]).toLowerCase(),by);}}var bz=bv.getElementsByTagName("div");for(var bl=0;bl<bz.length;bl++){bv=bz[bl];if(bz[bl].attributes){var bw=bz[bl].attributes;for(var bx=0;bx<bw.length;bx++){if((bw[bx]["name"])&&(bw[bx]["name"]!=undefined)&&(bw[bx].value!=undefined)&&(bw[bx]["name"]!="ID")&&(bw[bx].name!=null)){if(String(bw[bx]["name"]).toLowerCase()=="resize"){bu.push(bw[bx].value);}else{var by=bw[bx].value;by=by.replace(/#/g,"0x");bh.addVariable(String(bw[bx]["name"]).toLowerCase(),by);}}}}}}else{if((bt[q].id=="creative_menu_structure")&&(bt[q].id)){var bA=bB(bt[q]);bA=bA.replace(/\n/g,"{XTD_NEW_LINE}");bA=bA.replace(/\%/g,"%25");bA=bA.replace(/\&/g,"%26");bh.addVariable("menuText",bA.replace(/"/g,"{XTD_QT}"));bh.addVariable("xtd_cmd","true");}}}bh.addVariable("mainPath",bf());if(bs.getAttribute("menu_type")){bh.addVariable("menu_type",bs.getAttribute("menu_type"));}if(cs.getAttribute("title")){bh.addVariable("menu_type",cs.getAttribute("title"));}var bC=bu.join(";");bh.addVariable("resizes",bC);}function bB(bD){if(!bD){alert("refDiv: "+bD);return " ";}else{co=-1;for(var bE=0;bE<bD.childNodes.length;bE++){bF(bD.childNodes[bE]);}cn=cm;var bG="";for(var q=0;q<=co;q++){bG+=cn[q]+"\n";}return bG;}}function bF(S){try{if(S.getAttribute&&S.childNodes[0].innerHTML){var bH='';bH=S.childNodes[0].getAttribute("level");if(!bH){bH=S.childNodes[0].getAttribute("title");}cm[++co]=bH+S.childNodes[0].innerHTML.replace(/\\n/g,"{XTD_NL}");if(S.childNodes[0].getAttribute("href")||S.childNodes[0].getAttribute("target")||S.getAttribute("id")){var href=S.childNodes[0].getAttribute("href");if(S.childNodes[0].getAttribute("name")=="empty")href="";cm[co]+=","+href;}if(S.childNodes[0].getAttribute("target")||S.getAttribute("id"))cm[co]+=","+S.childNodes[0].getAttribute("target");if(S.getAttribute("id"))cm[co]+=","+S.getAttribute("id");}for(var bl=1;bl<S.childNodes.length;bl++){bF(S.childNodes[bl]);}}catch(bI){alert('error div 1 : '+bI);}}function bJ(){if(String(cp).indexOf('Firefox')!=-1||cp=="Camino")return 20;return 0;}function newSize(bK,width,height){var r=document.getElementById("creative_menu_"+bK);var cs=document.getElementById("menu_holder_"+bK);var bL=document.getElementById("creative_menu_"+bK+"_swf");var bM=(bN()>N())?bN():N();var bO=(bP()>bQ())?bP():bQ();var D=width;if(g[bK].u){D=Number(r.style.width.replace('px',''));}else{if(bp(r)+O()+D>=bM){D=bM-bp(r)-O()-bJ();}}if(D<g[bK].width)D=g[bK].width;var E=height;if(cp!="Opera"){if(Number(bR(r))+Number(bS())+Number(E)>=Number(bO)){E=bO-bR(r)+Number(bS())-1;}}if(E<g[bK].height)E=g[bK].height;r.style.width=D+"px";r.style.height=E+"px";if(ct())z(bK);if(A())B(bK);}function B(bK,bT){var r=g[bK].r;var cs=g[bK].cs;var bL=document.getElementById("creative_menu_"+bK+"_swf");var D=(g[bK].u)?Number(r.style.width.replace('px',''))+Math.abs(Number(cs.style.left.replace('px','')))+O():r.style.width.replace('px','');var E=r.style.height.replace('px','');bL.width=bL.height=0;if(bL.setAttribute){bL.setAttribute("width",D);bL.setAttribute("height",E);}else{bL.width=D;bL.height=E;}if(bT){if(cp.indexOf("Firefox")==0){cs.style.height=(Number(bL.height)+Number(bS()))+"px";bL.width="100%";bL.height="100%";}}}function z(bK){var r=g[bK].r;var cs=g[bK].cs;cs.style.height=r.style.height;cs.style.width=(Number(r.style.width.replace('px',''))+Math.abs(Number(cs.style.left.replace('px','')))+O())+'px';}function A(){if(cp=="Netscape")return true;if(cp.indexOf("Firefox")==0)return true;if(l=="Mac")return true;return false;}function ct(){if(cp=="Netscape"||cp.indexOf("Firefox")==0)return true;if(l=="Mac"&&(cp=="Mozilla"||cp=="Safari"||cp=="Opera"))return true;return false;}function L(bU,id,bV){if(bU&&bU.childNodes){var bW=bU.childNodes;type=(bV==undefined||bV=="")?"DIV":bV;for(var bl=0;bl<bW.length;bl++){if((bW[bl].id==id)&&(bW[bl].nodeName==type)){return bW[bl];}}}}function a(){var bX=navigator.userAgent;var bY="Other";if(bX.indexOf("Mozilla")==0)bY="Mozilla";if(bX.indexOf("MSIE 6")!=-1)bY="IE6";if(bX.indexOf("MSIE 7")!=-1)bY="IE7";if(bX.indexOf("MSIE 8")!=-1)bY="IE8";if(bX.indexOf("Opera")!=-1)bY="Opera";if(bX.indexOf("Firefox/1")!=-1)bY="Firefox1";if(bX.indexOf("Firefox/2")!=-1)bY="Firefox2";if(bX.indexOf("Firefox/3")!=-1)bY="Firefox3";if(bX.indexOf("Netscape")!=-1)bY="Netscape";if(bX.indexOf("Safari")!=-1)bY="Safari";if(bX.indexOf("Camino")!=-1)bY="Camino";return bY;}function m(){var bX=navigator.userAgent;var bZ="Other";if(bX.indexOf("Mac")!=-1)bZ="Mac";if(bX.indexOf("Win")!=-1)bZ="Win";return bZ;}function M(ca){var cb=0;while(ca!=null&&!cc(ca)){cb+=ca.offsetTop;ca=ca.offsetParent;}return cb;}function bn(ca){var cb=0;while(ca!=null&&!cc(ca)){cb+=ca.offsetLeft;ca=ca.offsetParent;}return cb;}function bp(ca){var cb=0;while(ca!=null){cb+=ca.offsetLeft;ca=ca.offsetParent;}return cb;}function bR(ca){var cb=0;while(ca!=null){cb+=ca.offsetTop;ca=ca.offsetParent;}return cb;}function bm(ca){var cb=0;while(ca!=null){if(cc(ca)){cb+=ca.offsetLeft;}ca=ca.offsetParent;}return cb;}function cd(ca){var cb=0;while(ca!=null){if(cc(ca)){cb+=ca.offsetTop;}ca=ca.offsetParent;}return cb;}function cc(bd){if(cu(bd,"position")=="absolute"||cu(bd,"position")=="fixed"||cu(bd,"position")=="relative")return true;}function N(){var cp=a();if(cp=="Safari"||cp=="Firefox3")return window.innerWidth;if(cp=="Opera"||cp=="Other"||cp=="Mozilla"){return document.body.clientWidth;}else{return document.documentElement.clientWidth;}}function bQ(){var cp=a();if(cp=="Safari"||cp=="Firefox3")return window.innerHeight;if(cp=="Opera"||cp=="Other"||cp=="Mozilla"){return document.body.clientHeight;}else{return document.documentElement.clientHeight;}}function cf(){return window.screen.width;}function cg(){return window.screen.height;}function bP(){document.body.offsetHeight;}function bN(){document.body.offsetWidth;}function O(){if(window.pageXOffset!=undefined){return window.pageXOffset;}else{return document.documentElement.scrollLeft;}}function bS(){if(window.pageYOffset!=undefined){return window.pageYOffset;}else{return document.documentElement.scrollTop;}}function cu(bd,cv){if(bd.currentStyle)var ci=bd.currentStyle[cv];else if(window.getComputedStyle)var ci=document.defaultView.getComputedStyle(bd,null).getPropertyValue(cv);if(cp=="Safari"&&l=="Mac"){var cj=document.defaultView.getComputedStyle(bd,null);var q=79;return cj[cv];}return ci;}}