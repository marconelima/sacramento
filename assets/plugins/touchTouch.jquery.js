!function(){var t=$('<div id="galleryOverlay">'),e=$('<div id="gallerySlider">'),n=$('<a id="prevArrow"></a>'),i=$('<a id="nextArrow"></a>'),o=!1;$.fn.touchTouch=function(){function a(e){if(o)return!1;t.show(),setTimeout(function(){t.addClass("visible")},100),c(e),o=!0}function r(){if(!o)return!1;t.hide().removeClass("visible"),o=!1,$(".placeholder").empty(),v=p}function c(t){e.css("left",100*-t+"%")}function l(t){setTimeout(function(){u(t)},1e3)}function u(t){if(t<0||t>=v.length)return!1;d(v.eq(t).attr("href"),function(){h.eq(t).html(this)})}function d(t,e){var n=$("<img>").on("load",function(){e.call(n)});n.attr("src",t)}function f(){g+1<v.length?(c(++g),l(g+1)):(e.addClass("rightSpring"),setTimeout(function(){e.removeClass("rightSpring")},500))}function s(){g>0?(c(--g),l(g-1)):(e.addClass("leftSpring"),setTimeout(function(){e.removeClass("leftSpring")},500))}var h=$([]),g=0,p=this,v=p;t.hide().appendTo("body"),e.appendTo(t),v.each(function(){h=h.add($('<div class="placeholder">'))}),e.append(h).on("click",function(t){$(t.target).is("img")||r()}),$("body").on("touchstart","#gallerySlider img",function(t){var n=t.originalEvent,i=n.changedTouches[0].pageX;return e.on("touchmove",function(t){t.preventDefault(),(n=t.originalEvent.touches[0]||t.originalEvent.changedTouches[0]).pageX-i>10?(e.off("touchmove"),s()):n.pageX-i<-10&&(e.off("touchmove"),f())}),!1}).on("touchend",function(){e.off("touchmove")}),v.on("click",function(t){t.preventDefault();var e,n,i=$(this),o=i.parent().closest("[data-gallery]");i.attr("data-gallery")?(e=i.attr("data-gallery"),n="item"):o.length&&(e=o.attr("data-gallery"),n="ancestor"),e&&"item"==n?v=$("[data-gallery="+e+"]"):e&&"ancestor"==n&&(v=v.filter(function(){return $(this).parent().closest("[data-gallery]").length})),a(g=v.index(this)),u(g),l(g+1),l(g-1)}),"ontouchstart"in window||(t.append(n).append(i),n.click(function(t){t.preventDefault(),s()}),i.click(function(t){t.preventDefault(),f()})),$(window).bind("keydown",function(t){37==t.keyCode?s():39==t.keyCode&&f()})}}(jQuery);
